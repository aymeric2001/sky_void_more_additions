# processes lava and dispenser markers
# @s = lava/dispenser marker
# located at @s
# run from skyvoid_additions:mechanics/calcite_from_dead_coral/clock
#place marker at dead coral pos
execute if entity @s[tag=skyvoid_additions_lava] align xyz positioned ~0.5 ~0.5 ~0.5 if block ~ ~1 ~ #skyvoid_additions:calcite_from_dead_coral_blocks/converts_to_calcite positioned ~ ~1 ~ unless entity @e[tag=skyvoid_additions_dead_coral_block,distance=..0.5,limit=1] run summon marker ~ ~ ~ {CustomName:'"skyvoid_additions_dead_coral_block"',Tags:["skyvoid_additions_dead_coral_block"]}
execute if entity @s[tag=skyvoid_additions_lava] align xyz positioned ~0.5 ~0.5 ~0.5 if block ~ ~-1 ~ #skyvoid_additions:calcite_from_dead_coral_blocks/converts_to_calcite positioned ~ ~-1 ~ unless entity @e[tag=skyvoid_additions_dead_coral_block,distance=..0.5,limit=1] run summon marker ~ ~ ~ {CustomName:'"skyvoid_additions_dead_coral_block"',Tags:["skyvoid_additions_dead_coral_block"]}
execute if entity @s[tag=skyvoid_additions_lava] align xyz positioned ~0.5 ~0.5 ~0.5 if block ~1 ~ ~ #skyvoid_additions:calcite_from_dead_coral_blocks/converts_to_calcite positioned ~1 ~ ~ unless entity @e[tag=skyvoid_additions_dead_coral_block,distance=..0.5,limit=1] run summon marker ~ ~ ~ {CustomName:'"skyvoid_additions_dead_coral_block"',Tags:["skyvoid_additions_dead_coral_block"]}
execute if entity @s[tag=skyvoid_additions_lava] align xyz positioned ~0.5 ~0.5 ~0.5 if block ~-1 ~ ~ #skyvoid_additions:calcite_from_dead_coral_blocks/converts_to_calcite positioned ~-1 ~ ~ unless entity @e[tag=skyvoid_additions_dead_coral_block,distance=..0.5,limit=1] run summon marker ~ ~ ~ {CustomName:'"skyvoid_additions_dead_coral_block"',Tags:["skyvoid_additions_dead_coral_block"]}
execute if entity @s[tag=skyvoid_additions_lava] align xyz positioned ~0.5 ~0.5 ~0.5 if block ~ ~ ~1 #skyvoid_additions:calcite_from_dead_coral_blocks/converts_to_calcite positioned ~ ~ ~1 unless entity @e[tag=skyvoid_additions_dead_coral_block,distance=..0.5,limit=1] run summon marker ~ ~ ~ {CustomName:'"skyvoid_additions_dead_coral_block"',Tags:["skyvoid_additions_dead_coral_block"]}
execute if entity @s[tag=skyvoid_additions_lava] align xyz positioned ~0.5 ~0.5 ~0.5 if block ~ ~ ~-1 #skyvoid_additions:calcite_from_dead_coral_blocks/converts_to_calcite positioned ~ ~ ~-1 unless entity @e[tag=skyvoid_additions_dead_coral_block,distance=..0.5,limit=1] run summon marker ~ ~ ~ {CustomName:'"skyvoid_additions_dead_coral_block"',Tags:["skyvoid_additions_dead_coral_block"]}

execute if entity @s[tag=skyvoid_additions_dispenser] positioned ^ ^ ^1 if block ~ ~1 ~ #skyvoid_additions:calcite_from_dead_coral_blocks/converts_to_calcite positioned ~ ~1 ~ unless entity @e[tag=skyvoid_additions_dead_coral_block,distance=..0.5,limit=1] run summon marker ~ ~ ~ {CustomName:'"skyvoid_additions_dead_coral_block"',Tags:["skyvoid_additions_dead_coral_block"]}
execute if entity @s[tag=skyvoid_additions_dispenser] positioned ^ ^ ^1 if block ~ ~-1 ~ #skyvoid_additions:calcite_from_dead_coral_blocks/converts_to_calcite positioned ~ ~-1 ~ unless entity @e[tag=skyvoid_additions_dead_coral_block,distance=..0.5,limit=1] run summon marker ~ ~ ~ {CustomName:'"skyvoid_additions_dead_coral_block"',Tags:["skyvoid_additions_dead_coral_block"]}
execute if entity @s[tag=skyvoid_additions_dispenser] positioned ^ ^ ^1 if block ~1 ~ ~ #skyvoid_additions:calcite_from_dead_coral_blocks/converts_to_calcite positioned ~1 ~ ~ unless entity @e[tag=skyvoid_additions_dead_coral_block,distance=..0.5,limit=1] run summon marker ~ ~ ~ {CustomName:'"skyvoid_additions_dead_coral_block"',Tags:["skyvoid_additions_dead_coral_block"]}
execute if entity @s[tag=skyvoid_additions_dispenser] positioned ^ ^ ^1 if block ~-1 ~ ~ #skyvoid_additions:calcite_from_dead_coral_blocks/converts_to_calcite positioned ~-1 ~ ~ unless entity @e[tag=skyvoid_additions_dead_coral_block,distance=..0.5,limit=1] run summon marker ~ ~ ~ {CustomName:'"skyvoid_additions_dead_coral_block"',Tags:["skyvoid_additions_dead_coral_block"]}
execute if entity @s[tag=skyvoid_additions_dispenser] positioned ^ ^ ^1 if block ~ ~ ~1 #skyvoid_additions:calcite_from_dead_coral_blocks/converts_to_calcite positioned ~ ~ ~1 unless entity @e[tag=skyvoid_additions_dead_coral_block,distance=..0.5,limit=1] run summon marker ~ ~ ~ {CustomName:'"skyvoid_additions_dead_coral_block"',Tags:["skyvoid_additions_dead_coral_block"]}
execute if entity @s[tag=skyvoid_additions_dispenser] positioned ^ ^ ^1 if block ~ ~ ~-1 #skyvoid_additions:calcite_from_dead_coral_blocks/converts_to_calcite positioned ~ ~ ~-1 unless entity @e[tag=skyvoid_additions_dead_coral_block,distance=..0.5,limit=1] run summon marker ~ ~ ~ {CustomName:'"skyvoid_additions_dead_coral_block"',Tags:["skyvoid_additions_dead_coral_block"]}

# kill if block no longer exists
execute if entity @s[tag=skyvoid_additions_lava] unless block ~ ~ ~ lava run kill @s
execute if entity @s[tag=skyvoid_additions_dispenser] unless block ~ ~ ~ dispenser run kill @s
